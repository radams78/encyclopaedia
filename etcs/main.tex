\documentclass{book}

\title{Mathematics}
\author{Robin Adams}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\let\proof\relax
\let\endproof\relax
\let\qed\relax
\usepackage{pf2}
\usepackage{hyperref}
\usepackage{mathabx}
\usepackage[all]{xy}

\newtheorem{ax}{Axiom}[chapter]
\newtheorem{prop}[ax]{Proposition}
\newtheorem{cor}{Corollary}[ax]
\newtheorem{thm}[ax]{Theorem}
\newtheorem{lm}[ax]{Lemma}
\theoremstyle{definition}
\newtheorem{df}[ax]{Definition}
\newtheorem{ex}[ax]{Example}

\newcommand{\id}[1]{\ensuremath{\mathrm{id}_{#1}}}
\newcommand{\inv}[1]{\ensuremath{{#1}^{-1}}}

\begin{document}

\maketitle
\tableofcontents

\chapter{Sets and Functions}

\section{Primitive Terms}

Let there be \emph{sets}.

Given sets $A$ and $B$, let there be \emph{functions} from $A$ to $B$. We write $f : A \rightarrow B$ iff $f$ is a function from $A$ to $B$, and call $A$ the \emph{domain} of $f$ and $B$ the \emph{codomain}.

Given functions $f : A \rightarrow B$ and $g : B \rightarrow C$, let there be a function $gf = g \circ f : A \rightarrow C$, the \emph{composite} of $f$ and $g$.

\section{Axioms}

\subsection{Associativity}
\begin{ax}[Associativity]
For any functions $f : A \rightarrow B$, $g : B \rightarrow C$ and $h : C \rightarrow D$ we have
\[ h (gf) = (hg) f \enspace . \]
\end{ax}

Thanks to this axiom, we shall often omit parentheses when writing the composite of a sequence of functions.

\subsection{Identity Functions}

\begin{df}[Identity Function]
For any set $A$, an \emph{identity function} on $A$ is a function $i : A \rightarrow A$ such that:
\begin{itemize}
\item for every set $B$ and function $f : A \rightarrow B$ we have $fi = f$;
\item for every set $B$ and function $f : B \rightarrow A$ we have $if = f$.
\end{itemize}
\end{df}

\begin{ax}[Identity Functions]
Every set has an identity function.
\end{ax}

\begin{prop}
Every set has a unique identity function.
\end{prop}

\begin{proof}
\pf
\step{1}{\pflet{$A$ be a set.}}
\step{2}{$A$ has an identity function.}
\begin{proof}
	\pf\ Axiom of Identity Functions
\end{proof}
\step{3}{For any identity functions $i$ and $j$ on $A$ we have $i = j$.}
\begin{proof}
	\step{a}{\pflet{$i$ and $j$ be identity functions on $A$.}}
	\step{b}{$i = j$}
	\begin{proof}
		\pf\ $i = ij = j$
	\end{proof}
\end{proof}
\qed
\end{proof}

\begin{df}[Identity Function]
For any set $A$, let $\id{A}$ be the identity function on $A$.
\end{df}

\begin{df}[Retraction, Section]
Let $r : A \rightarrow B$ and $s : B \rightarrow A$. Then $r$ is a \emph{retraction} of $s$, and $s$ is a \emph{section} of $r$, iff $rs = \id{B}$.
\end{df}

\begin{prop}
\label{prop:retraction_equals_section}
Let $f : A \rightarrow B$ and $g,h : B \rightarrow A$. If $g$ is a retraction of $f$ and $h$ is a section of $f$ then $g = h$.
\end{prop}

\begin{proof}
\pf
\begin{align*}
g & = g \id{B} \\
& = gfh \\
& = \id{A} h \\
& = h & \qed
\end{align*}
\end{proof}

\begin{df}[Bijection]
Let $f : A \rightarrow B$ be a function. We say $f$ is a \emph{bijection}, and write $f : A \approx B$, iff there exists a function $\inv{f} : B \rightarrow A$, an \emph{inverse} to $f$, such that $\inv{f} f = \id{A}$ and $f \inv{f} = \id{B}$.

Sets $A$ and $B$ are \emph{equinumerous}, $A \approx B$, iff there exists a bijection between them.
\end{df}

\begin{prop}
The inverse to a bijection is unique.
\end{prop}

\begin{proof}
\pf\ From Proposition \ref{prop:retraction_equals_section}. \qed
\end{proof}

\subsection{The Terminal Set}

\begin{df}[Terminal Set]
A set $T$ is \emph{terminal} iff, for every set $X$, there exists exactly one function $X \rightarrow T$.
\end{df}

\begin{ax}[Terminal Set]
There exists a terminal set.
\end{ax}

\begin{prop}
If $T$ and $T'$ are terminal sets then there exists a unique bijection $T \approx T'$.
\end{prop}

\begin{proof}
\pf
\step{1}{\pflet{$i$ be the unique function $T \rightarrow T'$}}
\step{2}{\pflet{$\inv{i}$ be the unique function $T' \rightarrow T$}}
\step{3}{$i \inv{i} = \id{T'}$}
\begin{proof}
	\pf\ Since there is only one function $T' \rightarrow T'$.
\end{proof}
\step{4}{$\inv{i} i = \id{T}$}
\begin{proof}
	\pf\ Since there is only one function $T \rightarrow T$.
\end{proof}
\qed
\end{proof}

\begin{df}
Let 1 be the terminal set. For any set $A$, let $!_A$ be the function $A \rightarrow 1$.
\end{df}

\begin{df}[Element]
For any set $A$, an \emph{element} of $A$ is a function $1 \rightarrow a$. We write $a \in A$ for $a : 1 \rightarrow A$.

Given $f : A \rightarrow B$ and $a \in A$, we write $f(a)$ for $fa : 1 \rightarrow B$.
\end{df}

\begin{ax}[Extensionality]
Let $A$ and $B$ be sets and $f,g : A \rightarrow B$.
If $\forall a \in A. f(a) = g(a)$ then $f = g$. \end{ax}

\subsection{The Empty Set}

\begin{ax}[Empty Set]
There exists a set that has no elements.
\end{ax}

\subsection{Products}

\begin{df}[Product]
Let $A$ and $B$ be sets. A \emph{product} of $A$ and $B$ consists of a set $A \times B$ and functions $\pi_1 : A \times B \rightarrow A$, $\pi_2 : A \times B \rightarrow B$, the \emph{projections}, such that, for any set $X$ and functions $f : X \rightarrow A$, $g : X \rightarrow B$, there exists a unique function $\langle f,g \rangle : X \rightarrow A \times B$ such that
\[ \pi_1 \circ \langle f,g \rangle = f, \qquad \pi_2 \circ \langle f,g \rangle = g \enspace . \]
\end{df}

\begin{ax}[Products]
Any two sets have a product.
\end{ax}

\begin{prop}
If $P$ and $Q$ are products of $A$ and $B$ with projections $p_1 : P \rightarrow A$, $p_2 : P \rightarrow B$, $q_1 : Q \rightarrow A$ and $q_2 : Q \rightarrow B$, then there exists a unique isomorphism $i : P \approx Q$ such that $q_1 i = p_1$ and $q_2 i = p_2$.
\end{prop}

\begin{proof}
\pf
\step{1}{\pflet{$i : P \rightarrow Q$ be the unique function such that $p_1 i = q_1$ and $p_2 i = q_2$.}}
\step{2}{\pflet{$\inv{i} : Q \rightarrow P$ be the unique function such that $q_1 \inv{i} = p_1$ and $q_2 \inv{i} = p_2$.}}
\step{3}{$\inv{i} i = \id{P}$}
\begin{proof}
	\pf\ Each is the unique $x$ such that $p_1 x = p_1$ and $p_2 x = p_2$.
\end{proof}
\step{4}{$i \inv{i} = \id{Q}$}
\begin{proof}
	\pf\ Each is the unique $x$ such that $q_1 x = q_1$ and $q_2 x = q_2$.
\end{proof}
\qed
\end{proof}

\begin{df}
For any sets $A$ and $B$, we write $A \times B$ for the product of $A$ and $B$, and $\pi_1 : A \times B \rightarrow A$, $\pi_2 : A \times B \rightarrow B$ for the projections. Given $f : X \rightarrow A$ and $g : X \rightarrow B$, we write $\langle f,g \rangle$ for the unique function $X \rightarrow A \times B$ such that
\[ \pi_1 \langle f,g \rangle = f, \qquad \pi_2 \langle f,g \rangle = g \enspace . \]
\end{df}

\begin{df}
Given functions $f : A \rightarrow B$ and $g : C \rightarrow D$, let $f \times g = \langle f \circ \pi_1, g \circ \pi_2 \rangle : A \times C \rightarrow B \times D$.
\end{df}

\subsection{Function Sets}

\begin{df}[Function Set]
Let $A$ and $B$ be sets. A \emph{function set} from $A$ to $B$ consists of a set $B^A$ and function $\epsilon : B^A \times A \rightarrow B$, the \emph{evaluation} map, such that, for any set $I$ and function $q : I \times A \rightarrow B$, there exists a unique function $\lambda q : I \rightarrow B^A$ such that $\epsilon \circ (\lambda q \times \id{A}) = q$.
\end{df}

\begin{ax}[Function Sets]
Any two sets have a function set.
\end{ax}

\begin{prop}
If $F$ and $G$ are function sets of $A$ and $B$ with evaluation maps $e : F \times A \rightarrow B$ and $e' : G \times A \rightarrow B$, then there exists a unique isomorphism $i : F \cong G$ such that $e'(i \times \id{A}) = e$.
\end{prop}

\begin{proof}
\pf
\step{1}{\pflet{$i : F \rightarrow G$ be the unique function such that $e'(i \times \id{A}) = e$.}}
\step{2}{\pflet{$\inv{i} : G \rightarrow F$ be the unique function such that $e(\inv{i} \times \id{A}) = e'$}}
\step{3}{$i \inv{i} = \id{G}$}
\begin{proof}
	\pf\ Each is the unique $x$ such that $e'(x \times \id{A}) = e'$.
\end{proof}
\step{4}{$\inv{i} i = \id{F}$}
\begin{proof}
	\pf\ Each is the unique $x$ such that $e(x \times \id{B}) = e$.
\end{proof}
\qed
\end{proof}

\subsection{Inverse Images}

\begin{df}[Pullback]
Let $p : A \rightarrow B$, $q : A \rightarrow C$, $f : B \rightarrow D$ and $g : C \rightarrow D$. Then we say that $A$, $p$ and $q$ form the \emph{pullback} of $f$ and $g$ if and only if:
\begin{itemize}
\item $fp = gq$
\item For any set $X$ and functions $x : X \rightarrow B$, $y : X \rightarrow C$ such that $fx = gy$, there exists a unique function $(x,y) : X \rightarrow A$ such that $p (x,y) = x$ and $q(x,y) = y$.
\end{itemize}
We also say $p$ is the pullback of $g$ along $f$, or $q$ is the pullback of $f$ along $g$.
\end{df}

\[ \xymatrix{
A \ar[r]^p \ar[d]_q & B \ar[d]^f \\
C \ar[r]_g & D
} \]

\begin{ax}[Inverse Images]
Given any function $f : X \rightarrow Y$ and element $y \in Y$, then there exists a pullback of $f$ and $y$.
\end{ax}

\subsection{The Subset Classifier}

\begin{df}[Injective]
A function $f : A \rightarrow B$ is \emph{injective} iff, for every set $X$ and functions $x,y : X \rightarrow A$, if $fx = fy$ then $x = y$.
\end{df}

\begin{df}[Subset Classifier]
A \emph{subset classifier} consists of a set $2$ and an element $\top \in 2$ such that, for any sets $A$ and $X$ and injective function $j : A \rightarrowtail X$, there exists a unique function $\chi : X \rightarrow 2$, the \emph{classifying function} of $j$, such that $j$ and $!_A : A \rightarrow 1$ form the pullback of $\top$ and $\chi$.
\end{df}

\[ \xymatrix{
A \ar[r]^{!_A} \ar[d]_j & 1 \ar[d]^{\top} \\
X \ar[r]_\chi & 2
} \]

\begin{ax}[Subset Classifier]
There exists a subset classifier.
\end{ax}

\begin{prop}
If $\top \in 2$ and $\top' \in 2'$ are subset classifiers, then there exists a unique isomorphism $i : 2 \approx 2'$ such that $i(\top) = \top'$.
\end{prop}

\begin{proof}
\pf
\step{1}{\pflet{$i : 2 \rightarrow 2'$ be the unique function such that $\top$ and $\id{1}$ form the pullback of $\top'$ and $i$}}
\step{2}{\pflet{$\inv{i} : 2' \rightarrow 2$ be the unique function such that $\top'$ and $\id{1}$ form the pullback of $\top$ and $\inv{i}$}}
\step{3}{$i \inv{i} = \id{2'}$}
\begin{proof}
	\pf\ Each is the unique $x$ such that $\top'$ and $\id{1}$ form the pullback of $\top'$ and $x$.
\end{proof}
\step{4}{$\inv{i} i = \id{2}$}
\begin{proof}
	\pf\ Each is the unique $x$ such that $\top$ and $\id{1}$ form the pullback of $\top$ and $x$.
\end{proof}
\qed
\end{proof}

\begin{df}
Let $2$ and $\top \in 2$ be the subset classifier.
\end{df}

\subsection{The Natural Numbers}

\begin{df}[Natural Numbers Set]
A \emph{natural numbers set} consists of a set $\mathbb{N}$, an element $0 \in \mathbb{N}$ and a function $s : \mathbb{N} \rightarrow \mathbb{N}$ such that, for any set $A$, element $a \in A$ and function $f : A \rightarrow A$, there exists a unique function $r : \mathbb{N} \rightarrow A$ such that $r(0) = a$ and $f \circ r = r \circ s$.
\end{df}

\begin{ax}[Infinity]
There exists a natural numbers set.
\end{ax}

\begin{prop}
If $N$, $0 \in N$, $s : N \rightarrow N$ and $N'$, $0' \in N'$, $s' : N' \rightarrow N'$ are two natural numbers sets, then there exists a unique isomorphism $i : N \approx N'$ such that $i(0) = 0'$ and $s'i = is$.
\end{prop}

\begin{proof}
\pf
\step{1}{\pflet{$i : N \rightarrow N'$ be the unique function such that $i(0) = 0'$ and $s'i = is$.}}
\step{2}{\pflet{$\inv{i} : N' \rightarrow N$ be the unique function such that $\inv{i}(0') = 0$ and $s \inv{i} = \inv{i} s'$.}}
\step{3}{$i \inv{i} = \id{N'}$}
\begin{proof}
	\pf\ Each is the unique $x$ such that $x(0') = 0'$ and $s'x = xs'$.
\end{proof}
\step{4}{$\inv{i} i = \id{N}$}
\begin{proof}
	\pf\ Each is the unique $x$ such that $x(0) = 0$ and $sx = xs$.
\end{proof}
\qed
\end{proof}

\subsection{The Axiom of Choice}

\begin{df}[Surjective]
A function $f : A \rightarrow B$ is \emph{surjective} iff, for every element $b \in B$, there exists $a \in A$ such that $f(a) = b$.
\end{df}

\begin{ax}[Choice]
Every surjective function has a section.
\end{ax}

\section{Sections and Retractions}

\begin{prop}
\label{prop:comp_section}
Let $r : A \rightarrow B$, $r' : B \rightarrow C$, $s : B \rightarrow A$ and $s' : C \rightarrow B$. If $s$ is a section of $r$ and $s'$ is a section of $r'$, then $ss'$ is a section of $r'r$.
\end{prop}

\begin{proof}
\pf\ Since $r'rss' = r' \id{B} s' = r's' = \id{C}$. \qed
\end{proof}

\section{Isomorphisms}

\begin{prop}
For any set $A$ we have $\id{A} : A \approx A$ and $\inv{\id{A}} = \id{A}$.
\end{prop}

\begin{proof}
\pf\ Immediate from the fact that $\id{A} \id{A} = \id{A}$. \qed
\end{proof}

\begin{prop}
If $f : A \approx B$ then $\inv{f} : B \approx A$ and $\inv{(\inv{f})} = f$.
\end{prop}

\begin{proof}
\pf\ Since $f \inv{f} = \id{B}$ and $\inv{f} f = \id{A}$. \qed
\end{proof}

\begin{prop}
If $f : A \approx B$ and $g : B \approx C$ then $gf : A \approx C$ and $\inv{(gf)} = \inv{f} \inv{g}$.
\end{prop}

\begin{proof}
\pf\ From Proposition \ref{prop:comp_section}. \qed
\end{proof}

\section{Subsets}

\begin{df}[Subset]
Let $i : U \rightarrow A$. Then we say that $(U,i)$ is a \emph{subset} of $A$ iff $i$ is injective.
\end{df}

\begin{df}
Let $(U,i)$ and $(V,j)$ be subsets of $A$. Then we say $(U,i)$ and $(V,j)$ are \emph{equal}, and write $(U,i) = (V,j)$, iff there exists an isomorphism $\phi : U \cong V$ such that $j \phi = i$.
\end{df}

%TODO This is an equivalence relation

%TODO Inclusion of subsets

\section{Intersections}

\begin{df}[Intersection]
Let $(U,i)$ and $(V,j)$ be subsets of a set $A$. 
Let $p : W \rightarrow U$ and $q : W \rightarrow V$ form the pullback of $i$ under $j$. Then
the \emph{intersection} of $(U,i)$ and $(V,j)$ is defined to be $(W, ip) = (W, jq)$.
\end{df}

\section{Pullbacks}

%TODO Pullbacks are unique up to isomorphism

\section{Functions}

\begin{prop}
Let $f : A \rightarrow B$. Then $f$ is injective if and only if, for all $x, y \in A$, if $f(x) = f(y)$ then $x = y$.
\end{prop}

\begin{proof}
\pf
\step{1}{If $f$ is injective then, for all $x,y \in A$, if $f(x) = f(y)$ then $x = y$.}
\begin{proof}
	\pf\ Immediate from the definition of injective.
\end{proof}
\step{2}{If $\forall x,y \in A. f(x) = f(y) \Rightarrow x = y$ then $f$ is injective.}
\begin{proof}
	\step{a}{\assume{$\forall x,y \in A. f(x) = f(y) \Rightarrow x = y$}}
	\step{b}{\pflet{$X$ be a set and $s,t : X \rightarrow A$}}
	\step{c}{\assume{$fs = ft$}}
	\step{d}{$\forall x \in X. s(x) = t(x)$}
	\begin{proof}
		\step{i}{\pflet{$x \in X$}}
		\step{ii}{$f(s(x)) = f(t(x))$}
		\begin{proof}
			\pf\ \stepref{c}
		\end{proof}
		\step{iii}{$s(x) = t(x)$}
		\begin{proof}
			\pf\ \stepref{a}
		\end{proof}
	\end{proof}
	\step{e}{$s = t$}
	\begin{proof}
		\pf\ Axiom of Extensionality
	\end{proof}
\end{proof}
\qed
\end{proof}

\section{The Internal Logic}

\begin{prop}
\label{prop:charfun}
Let $i : U \rightarrowtail A$ be injective. Let $\chi : A \rightarrow 2$ be its characteristic function. Then, for all $a \in A$, we have $\chi(a) = \top$ if and only if there exists $u \in U$ such that $i(u) = a$.
\end{prop}

\begin{proof}
\pf
\step{1}{If $\chi(a) = \top$ then there exists $u \in U$ such that $i(u) = a$.}
\begin{proof}
	\pf\ If $\chi \circ a = \top = \top \circ !_1$ then there exists a unique $u : 1 \rightarrow U$ such that $i \circ u = a$ and $!_U \circ u = !_1$.
\end{proof}
\step{2}{For all $u \in U$ we have $\chi(i(u)) = \top$.}
\begin{proof}
	\pf\ Since $\chi \circ i = \top \circ !_U$.
\end{proof}
\qed
\end{proof}

\begin{prop}
Subsets of a set $A$ are equal if and only if they have the same characteristic function.
\end{prop}

\begin{proof}
\pf\ Follows from the fact that pullbacks are unique up to isomorphism and the uniqueness of the characteristic function. \qed
\end{proof}

\begin{prop}
There are exactly two subsets of 1.
\end{prop}

\begin{proof}
\pf
\step{1}{\pick\ a set $E$ with no elements.}
\step{2}{$!_E : E \rightarrow 1$ is injective.}
\begin{proof}
	\pf\ Vacuously, $\forall x,y \in E. !_E(x) = !_E(y) \Rightarrow x = y$.
\end{proof}
\step{3}{$(E, !_E) \neq (1, \id{1})$}
\begin{proof}
	\pf\ Since there cannot be an isomorphism $1 \cong E$.
\end{proof}
\step{4}{For any subsets $(U,i)$ and $(V,j)$ of 1, if $(U,i) \neq (U,i) \cap (V,j)$ then $(U,i) = (1, \id{1})$}
\begin{proof}
	\step{i}{\pflet{$(U,i)$ and $(V,j)$ be subsets of 1.}}
	\step{ii}{\pflet{$p : W \rightarrow U$ and $q : W \rightarrow V$ form the intersection of $(U,i)$ and $(V,j)$}}
	\step{iii}{\assume{$(U,i) \neq (W,k)$}}
	\step{iv}{\pflet{$(U, \id{U}) \neq (W, p)$ as subsets of $U$.}}
	\step{vi}{\pflet{$\chi_U, \chi_W : U \rightarrow 2$ be the characteristic functions of $(U, \id{U})$ and $(W,p)$ respectively.}}
	\step{v}{$\chi_U \neq \chi_W$}
	\step{vi}{\pick\ $x \in U$}
	\begin{proof}
		\pf\ By the Axiom of Extensionality, there exists $x \in U$ such that $\chi_U(x) \neq \chi_W(x)$.
	\end{proof}
	\step{vi}{$ix = \id{1}$}
	\step{vii}{$x : 1 \cong U$}
	\step{viii}{$(U,i) = (1, \id{1})$} 
\end{proof}
\step{5}{For any subset $(U,i)$ of 1, either $(U,i) = (E, !_E)$ or $(U,i) = (1, \id{1})$.}
\begin{proof}
	\step{a}{\pflet{$(U,i)$ be a subset of 1.}}
	\step{b}{\assume{$(U,i) \neq (E, !_E)$}}
	\step{c}{$(U,i) \neq (U,i) \cap (E, !_E)$ or $(E, !_E) \neq (U,i) \cap (E, !_E)$}
	\step{d}{$(U,i) = (1, \id{1})$ or $(E, !_E) = (1, \id{1})$}
	\begin{proof}
		\pf\ \stepref{4}
	\end{proof}
	\step{e}{$(U,i) = (1, \id{1})$}
	\begin{proof}
		\pf\ \stepref{3}
	\end{proof}
\end{proof}
\qed
\end{proof}

\begin{cor}
There are exactly two elements of 2.
\end{cor}

\begin{df}[Falsehood]
Let \emph{falsehood} $\bot$ be the element of 2 that is not $\top$.
\end{df}

\begin{cor}
2 is the coproduct of 1 and 1 with injections $\top$ and $\bot$.
\end{cor}

\section{Functions}

\begin{prop}
Let $f : A \rightarrow B$, $g : B \rightarrow C$ and $a \in A$. Then
\[ (g \circ f)(a) = g(f(a)) \enspace . \]
\end{prop}

\begin{proof}
\pf\ Immediate from the Axiom of Associativity. \qed
\end{proof}

\begin{prop}
For any set $A$, any function $1 \rightarrow A$ is injective.
\end{prop}

\begin{proof}
\pf\ Since there is only one function $X \rightarrow 1$ for any set $X$. \qed
\end{proof}

\begin{prop}
Let $f : A \rightarrow B$. Then the following are equivalent:
\begin{enumerate}
\item $f$ is surjective.
\item $f$ is a retraction (i.e. $f$ has a section).
\item For any set $X$ and functions $x,y : B \rightarrow X$, if $xf = yf$ then $x = y$.
\end{enumerate}
\end{prop}

\begin{proof}
\pf
\step{1}{$1 \Rightarrow 2$}
\begin{proof}
	\pf\ Immediate from the Axiom of Choice.
\end{proof}
\step{2}{$2 \Rightarrow 3$}
\begin{proof}
	\step{a}{\pflet{$s : B \rightarrow A$ be a section of $f$.}}
	\step{b}{\pflet{$X$ be a set and $x,y : B \rightarrow X$ satisfy $xf = yf$.}}
	\step{c}{$x = y$}
	\begin{proof}
		\pf\ $x = xfs = yfs = y$
	\end{proof}
\end{proof}
\step{3}{$3 \Rightarrow 1$}
\begin{proof}
	\step{a}{\assume{3}}
	\step{b}{\pflet{$b \in B$}}
	\step{c}{\assume{for a contradiction $\forall a \in A. f(a) \neq b$}}
	\step{d}{\pflet{$\psi_1 : B \rightarrow 2$ be the characteristic function of $b$.}}
	\step{e}{\pflet{$\psi_2 = \bot \circ !_B : B \rightarrow 2$}}
	\step{f}{$\forall x \in A. \psi_1(f(x)) = \psi_2(f(x))$}
	\begin{proof}
		\step{i}{\pflet{$x \in A$}}
		\step{ii}{$\psi_1(f(x)) \neq \top$}
		\begin{proof}
			\pf\ Proposition \ref{prop:charfun}, \stepref{c}, \stepref{d}.
		\end{proof}
		\step{iii}{$\psi_1(f(x)) = \bot$}
		\step{iv}{$\psi_1(f(x)) = \psi_2(f(x))$}
	\end{proof}
	\step{g}{$\psi_1 \circ f = \psi_2 \circ f$}
	\begin{proof}
		\pf\ Axiom of Extensionality
	\end{proof}
	\step{h}{$\psi_1 = \psi_2$}
	\begin{proof}
		\pf\ \stepref{a}
	\end{proof}
	\step{i}{$\psi_1(b) \neq \psi_2(b)$}
	\begin{proof}
		\pf\ Since $\psi_1(b) = \top$ and $\psi_2(b) = \bot$.
	\end{proof}
	\qedstep
	\begin{proof}
		\pf\ This is a contradiction
	\end{proof}
\end{proof}
\qed
\end{proof}

\begin{cor}
A function is bijective iff it is injective and surjective.
\end{cor}

\section{Equalizers}

\begin{thm}
Any two functions $f,g : A \rightarrow B$ have an equalizer.
\end{thm}

\begin{proof}
\pf\ Take the inverse image of $\delta_B = \langle \id{B}, \id{B} \rangle : B \rightarrowtail B^2$ and $\langle f,g \rangle : A \rightarrow B^2$. \qed
\end{proof}

\section{The Empty Set}

\begin{thm}
If $E$ is a set with no elements, then $E$ has no proper subsets.
\end{thm}

\begin{proof}
\pf\ A proper subset of $E$ would give a proper subset of $1$ that is different from $(E, !_E)$. \qed
\end{proof}

\begin{thm}
If $E$ is a set with no elements, then for any set $X$ there exists exactly one function $E \rightarrow X$.
\end{thm}

\begin{proof}
\pf
\step{1}{\pflet{$E$ be a set with no elements.}}
\step{2}{\pflet{$X$ be a set.}}
\step{3}{There exists a function $E \rightarrow X$.}
\begin{proof}
	\step{a}{\pflet{$t : 1 \rightarrow 2^X$ be the name of the characteristic function of $\id{X} : X \rightarrow X$.}}
	\step{b}{\pflet{$\sigma : X \rightarrow 2^X$ be the lambda of the characteristic function of $\delta = \langle \id{X}, \id{X} \rangle : X \rightarrow X \times X$.}}
	\step{c}{\pflet{$p : P \rightarrow E$ and $q : P \rightarrow X$ be the pullback of $t \circ !_E$ and $\sigma$.}}
	\begin{proof}
		\pf\ $t \circ !_E$ is vacuously injective.
	\end{proof}
	\step{d}{$p$ is injective.}
	\begin{proof}
		\pf\ It is the pullback of the injective function $\sigma$.
	\end{proof}
	\step{e}{$p$ is bijective.}
	\step{f}{$q \circ p^{-1} : E \rightarrow X$}
\end{proof}
\step{4}{For any functions $f,g : E \rightarrow X$ we have $f = g$.}
\begin{proof}
	\step{a}{\pflet{$f,g : E \rightarrow X$}}
	\step{b}{\pflet{$m : M \rightarrow E$ be the pullback of $f$ and $g$.}}
	\step{c}{$(M,m) = (E, \id{E})$}
	\begin{proof}
		\pf\ Since $E$ has no proper subsets.
	\end{proof}
	\step{d}{$m : M \cong E$}
	\step{e}{$f = g$}
\end{proof}
\qed
\end{proof}

\begin{cor}
If $E$ and $E'$ are sets with no elements then there exists a unique isomorphism $E \cong E'$.
\end{cor}

\begin{df}[Empty Set]
Let the \emph{empty set} $\emptyset$ be the set with no elements.
\end{df}

\begin{thm}
For any set $A$, if there exists a function $A \rightarrow \emptyset$ then $A \cong \emptyset$.
\end{thm}

\begin{proof}
\pf\ If $f : A \rightarrow \emptyset$ then $A$ has no elements, because for any $a \in A$ we have $f(a) \in \emptyset$. \qed
\end{proof}

\section{Universal Quantification}

\begin{df}
For any set $A$, let $t_A : 1 \rightarrow 2^A$ be the name of the characteristic function of $\top \circ !_A : A \rightarrow 2$. Define \emph{universal quantification} $\forall_A : 2^A \rightarrow 2$ to be the characteristic function of $t_A$.
\end{df}

\section{Intersection}

\begin{thm}
Let $X$ be a set. There exists a function $\bigcap : 2^{2^X} \rightarrow 2^X$ such that, for all $S \in 2^{2^X}$ and $a \in X$, we have
\[ \epsilon(\bigcap S, a) = \top \Leftrightarrow \forall A \in 2^X. (\epsilon(S,A) = \top \Rightarrow \epsilon(A,a) = \top) \]
\end{thm}

\begin{proof}
\pf
\step{1}{\pflet{$X$ be a set.}}
\step{2}{\pflet{$\phi_2 : X \rightarrow 2^{2^X}$ be the lambda of $\epsilon : 2^X \times X \rightarrow 2$}}
\step{3}{\pflet{$F$ be the function
\[ \xymatrix{
2^{2^X} \times X \ar[r]^{\langle \id{2^{2^X}}, \phi_2 \rangle} &
2^{2^X} \times 2^{2^X} \ar[r]^{\cong} &
(2 \times 2)^{2^X} \ar[r]^{\Rightarrow} &
2^{2^X} \ar[r]^{\forall} & 2
} \]}}
\step{4}{\pflet{$\bigcap$ be the lambda}}
\qed
\end{proof}

\section{Union}

\begin{thm}
Any two subsets of a set have a union.
\end{thm}

\begin{proof}
\pf
\step{1}{\pflet{$A$ and $B$ be subsets of $X$}}
\step{2}{\pflet{$\chi_A \in 2^X$ be the name of the characteristic function of $A$.}}
\step{3}{\pflet{$t_X \in 2^X$ be the name of $\top \circ !_X : X \rightarrow 2$}}
\step{4}{\pflet{$C$ be the pullback of $t_X$ and $\chi_A \Rightarrow - : 2^X \rightarrow 2^X$}}
\step{5}{\pflet{$D$ be the pullback of $t_X$ and $\chi_B \Rightarrow -$}}
\step{6}{$\bigcap (C \cap D)$ is the union of $A$ and $B$.}
\qed
\end{proof}

\begin{thm}
Any two sets have a coproduct.
\end{thm}

\begin{proof}
\pf
\step{1}{\pflet{$X$ and $Y$ be sets.}}
\step{2}{\pflet{$\sigma_X : X \rightarrow 2^X$ be the lambda of the characteristic function of $\langle \id{X}, \id{X} \rangle : X \rightarrow X \times X$}}
\step{3}{\pflet{$\chi_0 : 1 \rightarrow Y$ be the characteristic function of the unique function $\emptyset \rightarrow Y$}}
\step{4}{\pflet{$i_X = \langle \sigma_X, \chi_0 \circ !_X \rangle : X \rightarrow 2^X \times 2^Y$}}
\step{5}{\pflet{$i_Y : Y \rightarrow 2^X \times 2^Y$ be defined similarly.}}
\step{6}{$i_X$ and $i_Y$ are monic.}
\step{7}{$\emptyset$ is the pullback of $i_X$ and $i_Y$ (i.e. $(X,i_X) \cap (Y, i_Y) = \emptyset)$.}
\step{8}{\pflet{$j : Z \rightarrow 2^X \times 2^Y$ be the union of $i_X$ and $i_Y$}}
\step{9}{$Z$ is the coproduct of $X$ and $Y$.}
\qed
\end{proof}

\end{document}